<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Simulate within and between host dynamics in an epidemic — simulateEpidemic • toyepidemic</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">


<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script>
<script src="../pkgdown.js"></script>
  
  
<!-- mathjax -->
<script src='https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">toyepidemic</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/UserGuide.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

      <div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Simulate within and between host dynamics in an epidemic</h1>
    </div>



    <pre class="usage"><span class='fu'>simulateEpidemic</span>(<span class='kw'>Ninit</span> <span class='kw'>=</span> <span class='fl'>Inf</span>, <span class='kw'>nu</span> <span class='kw'>=</span> <span class='fl'>0</span>, <span class='kw'>mu</span> <span class='kw'>=</span> <span class='fl'>1</span>/<span class='fl'>850</span>, <span class='no'>pe</span>, <span class='no'>sde</span>, <span class='no'>pg.init</span>,
  <span class='no'>GEValues</span>, <span class='no'>rateContact</span>, <span class='no'>rateInfect</span>, <span class='no'>rateDie</span>, <span class='no'>rateSample</span>, <span class='no'>rateMutate</span>,
  <span class='kw'>rateTransTemplate</span> <span class='kw'>=</span> <span class='fu'><a href='generateRateTransTemplate.html'>generateRateTransTemplate</a></span>(<span class='no'>numsAllelesAtSites</span>),
  <span class='kw'>numsAllelesAtSites</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>eUniqForEachG</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>selectWithinHost</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>timeStep</span> <span class='kw'>=</span> <span class='fl'>0.1</span>, <span class='kw'>maxTime</span> <span class='kw'>=</span> <span class='fl'>1200</span>,
  <span class='kw'>maxNTips</span> <span class='kw'>=</span> <span class='fl'>8000</span>, <span class='kw'>expandTimeAfterMaxNTips</span> <span class='kw'>=</span> <span class='fl'>1.5</span>, <span class='kw'>reportInterval</span> <span class='kw'>=</span> <span class='fl'>12</span>,
  <span class='no'>...</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a> Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>Ninit</th>
      <td><p>integer, initial population size</p></td>
    </tr>
    <tr>
      <th>nu</th>
      <td><p>numeric, birth rate (constant unit time influx in the population)</p></td>
    </tr>
    <tr>
      <th>mu</th>
      <td><p>numeric, natural death rate</p></td>
    </tr>
    <tr>
      <th>pe</th>
      <td><p>numeric vector of frequences for each environment type</p></td>
    </tr>
    <tr>
      <th>sde</th>
      <td><p>numeric, the standard deviation of the special environmental
effects</p></td>
    </tr>
    <tr>
      <th>pg.init</th>
      <td><p>numeric initial frequencies from which the pathogen genotype
of the first case is drawn</p></td>
    </tr>
    <tr>
      <th>GEValues</th>
      <td><p>numeric matrix with average value for individuals of specific
immune system type infected by a specific pathogen. GEValues[i, j] is for
individaul of immune type i and pathogen genotype j.</p></td>
    </tr>
    <tr>
      <th>rateContact</th>
      <td><p>numeric, the rate at which an infected individual has
contact with a susceptible.</p></td>
    </tr>
    <tr>
      <th>rateInfect</th>
      <td><p>a function of two arguments, a numeric vector of trait
values and a numeric rateContact parameter, returning a numeric vector of
transmission rates corresponding z.</p></td>
    </tr>
    <tr>
      <th>rateDie</th>
      <td><p>a function of one argument, a numeric vector of trait values,
returning a numeric vector of death rates corresponding to these values.</p></td>
    </tr>
    <tr>
      <th>rateSample</th>
      <td><p>numeric, the rate at which infected individuals get
diagnozed and recover</p></td>
    </tr>
    <tr>
      <th>rateMutate</th>
      <td><p>a function of four arguments: the GEValues matrix (see
above), a numeric vector es of special environmental effects, an integer
vector envs of environment type indices and an integer vector genes of
pathogen genotype indices, returning a numeric vector of the same size as
the es with per-locus mutation rates.</p></td>
    </tr>
    <tr>
      <th>rateTransTemplate</th>
      <td><p>a square matrix of size n x (n-1) containing the
factor by which the per locus mutation rate must be multiplied in order to
obtain a transition rate between any two pathogen genotypes. See the
function generateRateTransTemplate. rateTransTemplate[i,j] should be the
factor for transition rate from state i to state j. By definition of
transition rate matrices the transition from a state to itself is always
the negative sum of the transition rates to the other states. This
parameter needs not to be specified explicitly if the parameter
numsAllelesAtSites is specified (see below).</p></td>
    </tr>
    <tr>
      <th>numsAllelesAtSites</th>
      <td><p>integer vector specifying the number of alleles at
each site, the length of the vector defining the number of QTLs.</p></td>
    </tr>
    <tr>
      <th>eUniqForEachG</th>
      <td><p>logical indicating should the special environmental
effect in an individual be drawn for each possible pathogen genotype or
should there be a single special environmental effect for all genotypes.</p></td>
    </tr>
    <tr>
      <th>selectWithinHost</th>
      <td><p>logical indicating if there is selection for higher
trait values within a host. When TRUE a mutation results in a transition
from one genotype to another only if it results in a higher trait value for
a host.</p></td>
    </tr>
    <tr>
      <th>timeStep</th>
      <td><p>numeric, the time resolution at which infection, mutation,
sampling and death events are sampled.</p></td>
    </tr>
    <tr>
      <th>maxTime</th>
      <td><p>numeric, the maximum duration of a simulation before starting
the graceful fade-away phase.</p></td>
    </tr>
    <tr>
      <th>maxNTips</th>
      <td><p>numeric, the maximum number of sampled individuals before
starting the graceful fade-away phase.</p></td>
    </tr>
    <tr>
      <th>expandTimeAfterMaxNTips</th>
      <td><p>numeric greater or equal than 1 specifying how
lone should the growth of the epidemic continue after reaching maxNTips or
running the epidemic for maxTime/expandTimeAfterMaxNTips.</p></td>
    </tr>
    <tr>
      <th>reportInterval</th>
      <td><p>positive integer, time interval at which some
statistics such as total infected and recovered counts and frequencies of
genotypes in the population are stored.</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A list of objects</p>
    

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>
          </ul>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Venelin Mitov.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  </body>
</html>
